# arduino-td4-rom

渡波郁『CPU の創り方』（マイナビ出版、2003 年）で作る CPU（TD4）用の ROM とクロックジェネレーターを Arduino でエミュレートするためのコードです。

## 使用 IC

- 74HC10（キャリーフラグ）
- 74HC32（命令デコーダ）
- 74HC74（命令デコーダ）
- 74HC153 × 2（データセレクタ）
- 74HC163 × 4（A レジスタ、B レジスタ、出力ポート、プログラムカウンタ）
  - 書籍では 74HC161 が使われていますが、入手できなかったため 74HC163 を使用しました。リセットがクロックの立ち上がりに同期しているか（74HC163）していないか（74HC163）という違いがあります。
- 74HC283（ALU）

## Arduino との接続

Arduino Uno R3 ボードで動作確認しています。

| Arduino のピン  | 用途                                           | 接続先                                             |
| --------------- | ---------------------------------------------- | -------------------------------------------------- |
| デジタルピン 2  | クロック                                       | 74HC74、74HC163 × 4 のクロック入力（CK）           |
| デジタルピン 3  | リセット                                       | 74HC74、74HC163 × 4 のリセット入力（CLR）          |
| デジタルピン 6  | プログラムカウンタ（1 桁目）                   | プログラムカウンタ用 74HC163 の 14 番ピン（QA）    |
| デジタルピン 7  | プログラムカウンタ（2 桁目）                   | プログラムカウンタ用 74HC163 の 13 番ピン（QB）    |
| デジタルピン 8  | プログラムカウンタ（3 桁目）                   | プログラムカウンタ用 74HC163 の 12 番ピン（QC）    |
| デジタルピン 9  | プログラムカウンタ（4 桁目）                   | プログラムカウンタ用 74HC163 の 11 番ピン（QD）    |
| デジタルピン 10 | ROM からの出力（イミディエイトデータ、1 桁目） | 74HC283 の 6 番ピン（B1）                          |
| デジタルピン 11 | ROM からの出力（イミディエイトデータ、2 桁目） | 74HC283 の 2 番ピン（B2）                          |
| デジタルピン 12 | ROM からの出力（イミディエイトデータ、3 桁目） | 74HC283 の 15 番ピン（B3）                         |
| デジタルピン 13 | ROM からの出力（イミディエイトデータ、4 桁目） | 74HC283 の 11 番ピン（B4）                         |
| アナログピン A1 | ROM からの出力（オペレーションコード、1 桁目） | 74HC32 の 2 番・5 番ピン                           |
| アナログピン A2 | ROM からの出力（オペレーションコード、2 桁目） | 74HC153 × 2 の 2 番ピン（B）                       |
| アナログピン A3 | ROM からの出力（オペレーションコード、3 桁目） | 74HC10 の 9 番・13 番ピン、74HC32 の 9 番ピン      |
| アナログピン A4 | ROM からの出力（オペレーションコード、4 桁目） | 74HC10 の 5・10 番ピン、74HC32 の 1・10・13 番ピン |
